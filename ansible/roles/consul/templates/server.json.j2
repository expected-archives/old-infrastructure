{
  "datacenter": {{ consul_datacenter | to_json }},
  "data_dir": "/var/lib/consul",
  "log_level": "INFO",
  "server": true,
  "ui": {{ consul_enable_ui | to_json }},
  "bootstrap_expect": {{ groups['master'] | map('extract', hostvars, ['private_ip']) | list | length | to_json }},
  "retry_join": {{ groups['master'] | map('extract', hostvars, ['private_ip']) | list | to_json }},
  "rejoin_after_leave": true,
  {% if consul_encryption %}
  "encrypt": {{ consul_encryption | to_json }},
  "verify_outgoing": true,
  "verify_incoming": true,
  {% endif %}
  "bind_addr": {{ hostvars[inventory_hostname].private_ip | to_json }}
}
